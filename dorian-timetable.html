<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dorian's Timetable - 3rd Grade</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--bg);
      color: var(--text);
      transition: background 0.3s, color 0.3s;
    }

    :root {
      --bg: #f8faff;
      --text: #333;
      --card: #fff;
      --header-bg: #4f46e5;
      --header-text: #fff;
      --border: #ddd;
      --cell-border: #eee;
    }

    body.dark {
      --bg: #1e1e2f;
      --text: #e0e0e0;
      --card: #2c2c3c;
      --header-bg: #6366f1;
      --header-text: #fff;
      --border: #444;
      --cell-border: #555;
    }

    h1 {
      text-align: center;
      margin-bottom: 5px;
    }

    h2, h3 {
      text-align: center;
      font-size: 1rem;
      margin: 4px 0;
    }

    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    select, button {
      padding: 6px 12px;
      font-size: 0.9rem;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--text);
      cursor: pointer;
    }

    button:hover, select:hover {
      opacity: 0.9;
    }

    .timetable {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
      background: var(--card);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      margin-top: 20px;
    }

    .timetable div {
      border: 1px solid var(--cell-border);
      padding: 12px;
      text-align: center;
      font-size: 0.9rem;
      position: relative;
    }

    .header {
      background: var(--header-bg);
      color: var(--header-text);
      font-weight: bold;
    }

    /* Tooltip styling */
    .tooltip {
      position: absolute;
      bottom: 110%;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      padding: 5px 8px;
      border-radius: 5px;
      font-size: 0.75rem;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease;
      z-index: 10;
    }

    .timetable div:hover .tooltip,
    .timetable div:active .tooltip {
      opacity: 1;
    }

    @media (max-width: 768px) {
      .timetable div {
        font-size: 0.75rem;
        padding: 8px;
      }
    }
  </style>
</head>
<body>
  <h1 id="title"></h1>
  <div class="controls">
    <button id="theme-toggle">üåô Dark</button>
    <select id="language-select">
      <option value="en">English üá¨üáß</option>
      <option value="bs">Bosanski üáßüá¶</option>
      <option value="tr">T√ºrk√ße üáπüá∑</option>
    </select>
  </div>
  <h2 id="today-date"></h2>
  <h3 id="shift-label"></h3>
  <h3 id="shift-time"></h3>

  <div class="timetable" id="timetable"></div>

  <script>
    const translations = {
      en: {
        title: "Dorian's Timetable - 3B",
        morning: "Morning Shift",
        afternoon: "Afternoon Shift",
        morningTime: "from 08:00 to 11:30",
        afternoonTime: "from 14:00 to 17:30",
        morningTimeFriday: "from 08:00 to 10:40",
        afternoonTimeFriday: "from 14:00 to 16:40",
        days: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
        locale: "en-GB",
        subjects: {
          'BHS': 'BHS Language & Literature',
          'ENG': 'English',
          'MO': 'My Environment',
          'MAT': 'Mathematics',
          'MSC': 'Music',
          'LK': 'Art',
          'DKR': 'Society/Culture/Religion',
          'TZO': 'Physical & Health Education',
          'INFO': 'Computer Science'
        }
      },
      bs: {
        title: "Dorianov Raspored ƒåasova - 3B",
        morning: "Prva smjena",
        afternoon: "Druga smjena",
        morningTime: "od 08:00 do 11:30",
        afternoonTime: "od 14:00 do 17:30",
        morningTimeFriday: "od 08:00 do 10:40",
        afternoonTimeFriday: "od 14:00 do 16:40",
        days: ["Ponedjeljak", "Utorak", "Srijeda", "ƒåetvrtak", "Petak"],
        locale: "bs-BA",
        subjects: {
          'BHS': 'BHS Jezik i knji≈æevnost',
          'ENG': 'Engleski jezik',
          'MO': 'Moja Okolina',
          'MAT': 'Matematika',
          'MSC': 'Muziƒçka kultura',
          'LK': 'Likovna kultura',
          'DKR': 'Dru≈°tvo/Kultura/Religija',
          'TZO': 'Tjelesni i zdravstveni odgoj',
          'INFO': 'Informatika'
        }
      },
      tr: {
        title: "Dorian'ƒ±n Ders Programƒ± - 3B",
        morning: "Sabah√ßƒ±",
        afternoon: "√ñƒülenci",
        morningTime: "08:00 - 11:30",
        afternoonTime: "14:00 - 17:30",
        morningTimeFriday: "08:00 - 10:40",
        afternoonTimeFriday: "14:00 - 16:40",
        days: ["Pazartesi", "Salƒ±", "√áar≈üamba", "Per≈üembe", "Cuma"],
        locale: "tr-TR",
        subjects: {
          'BHS': 'BHS Dil ve Edebiyat',
          'ENG': 'ƒ∞ngilizce',
          'MO': '√áevrem',
          'MAT': 'Matematik',
          'MSC': 'M√ºzik',
          'LK': 'Resim',
          'DKR': 'Toplum/K√ºlt√ºr/Din',
          'TZO': 'Beden Eƒüitimi',
          'INFO': 'Bilgisayar Bilimi'
        }
      }
    };

    const timetableData = {
      morning: {
        'Monday': ['ENG', 'BHS', 'MSC', 'MAT'],
        'Tuesday': ['TZO', 'DKR', 'BHS', 'MO'],
        'Wednesday': ['MAT', 'INFO', 'MO', 'ENG'],
        'Thursday': ['LK', 'BHS', 'TZO', 'MSC'],
        'Friday': ['BHS', 'MAT', 'LK']
      },
      afternoon: {
        'Monday': ['ENG', 'BHS', 'MSC', 'MAT'],
        'Tuesday': ['TZO', 'DKR', 'BHS', 'MO'],
        'Wednesday': ['MAT', 'INFO', 'MO', 'ENG'],
        'Thursday': ['LK', 'BHS', 'TZO', 'MSC'],
        'Friday': ['BHS', 'MAT', 'LK']
      }
    };

    // Reference: week of 1st September 2025 = Afternoon
    function getShiftForWeek(date) {
      const referenceDate = new Date(2025, 8, 1); // Sep 1, 2025
      const oneWeek = 1000 * 60 * 60 * 24 * 7;
      const diffWeeks = Math.floor((date - referenceDate) / oneWeek);
      return diffWeeks % 2 === 0 ? 'afternoon' : 'morning';
    }

    function buildTimetable(shift, lang) {
      const table = document.getElementById("timetable");
      table.innerHTML = "";

      const tr = translations[lang];
      const days = tr.days;

      // Header row
      days.forEach(day => {
        table.appendChild(createCell(day, "header"));
      });

      // Max lessons in a day
      const maxPeriods = Math.max(...Object.values(timetableData[shift]).map(d => d.length));

      for (let p = 0; p < maxPeriods; p++) {
        Object.keys(timetableData[shift]).forEach((dayKey, idx) => {
          const code = timetableData[shift][dayKey][p] || "";
          const full = tr.subjects[code] || "";
          table.appendChild(createCell(code, "", full));
        });
      }
    }

    function createCell(text, className, tooltipText = "") {
      const div = document.createElement("div");
      if (className) div.classList.add(className);
      div.textContent = text;
      if (tooltipText) {
        const tooltip = document.createElement("span");
        tooltip.className = "tooltip";
        tooltip.textContent = tooltipText;
        div.appendChild(tooltip);
      }
      return div;
    }

    function render(lang) {
      const today = new Date();
      const shift = getShiftForWeek(today);
      const tr = translations[lang];

      // Title
      document.getElementById("title").textContent = tr.title;

      // Today date
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      document.getElementById("today-date").textContent = today.toLocaleDateString(tr.locale, options);

      // Shift label + times
      const isFriday = today.getDay() === 5; // Friday = 5
      if (shift === "morning") {
        document.getElementById("shift-label").textContent = tr.morning;
        document.getElementById("shift-time").textContent = isFriday ? tr.morningTimeFriday : tr.morningTime;
      } else {
        document.getElementById("shift-label").textContent = tr.afternoon;
        document.getElementById("shift-time").textContent = isFriday ? tr.afternoonTimeFriday : tr.afternoonTime;
      }

      // Build table
      buildTimetable(shift, lang);
    }

    // Theme toggle
    const themeBtn = document.getElementById("theme-toggle");
    themeBtn.addEventListener("click", () => {
      document.body.classList.toggle("dark");
      const dark = document.body.classList.contains("dark");
      themeBtn.textContent = dark ? "‚òÄÔ∏è Light" : "üåô Dark";
      localStorage.setItem("theme", dark ? "dark" : "light");
    });

    // Language select
    const langSelect = document.getElementById("language-select");
    langSelect.addEventListener("change", () => {
      const lang = langSelect.value;
      localStorage.setItem("lang", lang);
      render(lang);
    });

    // Init
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "dark") {
      document.body.classList.add("dark");
      themeBtn.textContent = "‚òÄÔ∏è Light";
    }

    const savedLang = localStorage.getItem("lang") || "en";
    langSelect.value = savedLang;
    render(savedLang);
  </script>
</body>
</html>
